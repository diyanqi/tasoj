{"status": "Partial Accepted", "problem_id": 1203, "language": "cpp", "username": "diyanqi@qq.com", "code": "#pragma GCC optimize(2)\n#include<bits/stdc++.h>\n#define ll long long\nusing namespace std;\ninline int read(){\n\tchar c=getchar();int x=0,f=1;\n    while(c<'0'||c>'9'){if(c=='-')f=-1;c=getchar();}\n    while(c>='0'&&c<='9'){x=x*10+c-'0';c=getchar();}\n    return x*f;\n}\nconst int maxn=100010*4;\nstruct Complex{\n\tdouble x,y;\n};\nComplex operator +(Complex a,Complex b){return (Complex){a.x+b.x,a.y+b.y};}\nComplex operator -(Complex a,Complex b){return (Complex){a.x-b.x,a.y-b.y};}\nComplex operator *(Complex a,Complex b){return (Complex){a.x*b.x-a.y*b.y,a.x*b.y+a.y*b.x};}\nconst double Pi=acos(-1.0);\nComplex get_w(int k,int len,bool op){\n\tint T=1;if(!op)T=-1;\n\treturn (Complex){cos(2.0*k*Pi/len),T*sin(2.0*k*Pi/len)};\n}\nComplex A[maxn],B[maxn];\nint i,j,k,n,m;\nint R[maxn];\nchar C[4]={'A','T','C','G'};\nvoid FFT(int len,Complex *a,bool op){\n\tfor(int i=0;i<len;i++)\n\t\tif(i<R[i])swap(a[i],a[R[i]]);\n\tfor(int i=1;i<len;i=i*2){\n\t\tComplex w,Wn=get_w(1,i*2,op);\n\t\tfor(int j=0;j<len;j+=i*2){\n\t\t\tw=(Complex){1,0};\n\t\t\tfor(int k=0;k<i;k++,w=w*Wn){\n\t\t\t\tint K=k+j;\n\t\t\t\tComplex S1=a[K],S2=w*a[K+i];\n\t\t\t\ta[K]=S1+S2;\n\t\t\t\ta[K+i]=S1-S2;\n\t\t\t}\n\t\t}\n\t}\n}\nint Ans[maxn],ans;\nint main(){\n\tint T;\n\tcin>>T;\n\tstring None_;\n\tgetline(cin,None_);\n\twhile(T--){\n\t\tmemset(Ans,0,sizeof(Ans));ans=0;\n\t\tstring S,T;\n\t\tcin>>S>>T;\n\t\tn=S.size();\n\t\tm=T.size();\n\t\tfor(i=0;i<4;i++){\n\t\t\tfor(j=0;j<n;j++)\n\t\t\t\tA[j]=(Complex){(S[j]==C[i]),0};\n\t\t\tfor(j=0;j<m;j++)\n\t\t\t\tB[m-j-1]=(Complex){(T[j]==C[i]),0};\n\t\t\tint len=1,L=0;\n\t\t\twhile(len<=n+m)len*=2,++L;\n\t\t\tfor(j=0;j<len;j++)\n\t\t\t\tR[j]=R[j/2]/2+(j%2)*(1<<L-1);\n\t\t\tFFT(len,A,true);FFT(len,B,true);\n\t\t\tfor(j=0;j<len;j++)A[j]=A[j]*B[j];\n\t\t\tFFT(len,A,false);\n\t\t\tfor(j=m-1;j<=m+n-1;j++)\n\t\t\t\tAns[j-(m-1)]+=((int)(A[j].x/len+0.5));\n\t\t\tfor(j=0;j<len;j++)A[j]=B[j]=(Complex){0,0};\n\t\t}\n\t\tfor(i=0;i<n-m+1;i++)\n\t\t\tif(Ans[i]+3>=m)++ans;\n\t\tcout<<ans<<endl;\n\t}\n\treturn 0;\n}", "msg": "", "testpoints": [{"testpoint": 1, "status": "Time Limit Exceeded", "msg": "", "time": 1104836179, "memory": 9281536}, {"testpoint": 2, "status": "Time Limit Exceeded", "msg": "", "time": 1105816799, "memory": 9338880}, {"testpoint": 3, "status": "Accepted", "msg": "", "time": 151767249, "memory": 4947968}, {"testpoint": 4, "status": "Time Limit Exceeded", "msg": "", "time": 1105571913, "memory": 9338880}, {"testpoint": 5, "status": "Time Limit Exceeded", "msg": "", "time": 1105576659, "memory": 9383936}, {"testpoint": 6, "status": "Time Limit Exceeded", "msg": "", "time": 1128801730, "memory": 9388032}, {"testpoint": 7, "status": "Time Limit Exceeded", "msg": "", "time": 1104526763, "memory": 9388032}, {"testpoint": 8, "status": "Accepted", "msg": "", "time": 7874179, "memory": 4911104}, {"testpoint": 9, "status": "Accepted", "msg": "", "time": 44940392, "memory": 4911104}, {"testpoint": 10, "status": "Time Limit Exceeded", "msg": "", "time": 1104954578, "memory": 6959104}, {"testpoint": 11, "status": "Time Limit Exceeded", "msg": "", "time": 1105673187, "memory": 9383936}], "score": 30, "scorerate": "27%"}