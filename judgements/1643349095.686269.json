{"status": "Partial Accepted", "problem_id": 1203, "language": "cpp", "username": "diyanqi@qq.com", "code": "#include<bits/stdc++.h>\r\n#define ll long long\r\nusing namespace std;\r\ninline int read(){\r\n\tchar c=getchar();int x=0,f=1;\r\n    while(c<'0'||c>'9'){if(c=='-')f=-1;c=getchar();}\r\n    while(c>='0'&&c<='9'){x=x*10+c-'0';c=getchar();}\r\n    return x*f;\r\n}\r\nconst int maxn=100010*4;\r\nstruct Complex{\r\n\tdouble x,y;\r\n};\r\nComplex operator +(Complex a,Complex b){return (Complex){a.x+b.x,a.y+b.y};}\r\nComplex operator -(Complex a,Complex b){return (Complex){a.x-b.x,a.y-b.y};}\r\nComplex operator *(Complex a,Complex b){return (Complex){a.x*b.x-a.y*b.y,a.x*b.y+a.y*b.x};}\r\nconst double Pi=acos(-1.0);\r\nComplex get_w(int k,int len,bool op){\r\n\tint T=1;if(!op)T=-1;\r\n\treturn (Complex){cos(2.0*k*Pi/len),T*sin(2.0*k*Pi/len)};\r\n}\r\nComplex A[maxn],B[maxn];\r\nint i,j,k,n,m;\r\nint R[maxn];\r\nchar C[4]={'A','T','C','G'};\r\nvoid FFT(int len,Complex *a,bool op){\r\n\tfor(int i=0;i<len;i++)\r\n\t\tif(i<R[i])swap(a[i],a[R[i]]);\r\n\tfor(int i=1;i<len;i=i*2){\r\n\t\tComplex w,Wn=get_w(1,i*2,op);\r\n\t\tfor(int j=0;j<len;j+=i*2){\r\n\t\t\tw=(Complex){1,0};\r\n\t\t\tfor(int k=0;k<i;k++,w=w*Wn){\r\n\t\t\t\tint K=k+j;\r\n\t\t\t\tComplex S1=a[K],S2=w*a[K+i];\r\n\t\t\t\ta[K]=S1+S2;\r\n\t\t\t\ta[K+i]=S1-S2;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\nint Ans[maxn],ans;\r\nint main(){\r\n\tint T;\r\n\tcin>>T;\r\n\tstring None_;\r\n\tgetline(cin,None_);\r\n\twhile(T--){\r\n\t\tmemset(Ans,0,sizeof(Ans));ans=0;\r\n\t\tstring S,T;\r\n\t\tcin>>S>>T;\r\n\t\tn=S.size();\r\n\t\tm=T.size();\r\n\t\tfor(i=0;i<4;i++){\r\n\t\t\tfor(j=0;j<n;j++)\r\n\t\t\t\tA[j]=(Complex){(S[j]==C[i]),0};\r\n\t\t\tfor(j=0;j<m;j++)\r\n\t\t\t\tB[m-j-1]=(Complex){(T[j]==C[i]),0};\r\n\t\t\tint len=1,L=0;\r\n\t\t\twhile(len<=n+m)len*=2,++L;\r\n\t\t\tfor(j=0;j<len;j++)\r\n\t\t\t\tR[j]=R[j/2]/2+(j%2)*(1<<L-1);\r\n\t\t\tFFT(len,A,true);FFT(len,B,true);\r\n\t\t\tfor(j=0;j<len;j++)A[j]=A[j]*B[j];\r\n\t\t\tFFT(len,A,false);\r\n\t\t\tfor(j=m-1;j<=m+n-1;j++)\r\n\t\t\t\tAns[j-(m-1)]+=((int)(A[j].x/len+0.5));\r\n\t\t\tfor(j=0;j<len;j++)A[j]=B[j]=(Complex){0,0};\r\n\t\t}\r\n\t\tfor(i=0;i<n-m+1;i++)\r\n\t\t\tif(Ans[i]+3>=m)++ans;\r\n\t\tcout<<ans<<endl;\r\n\t}\r\n\treturn 0;\r\n}", "msg": "", "testpoints": [{"testpoint": 1, "status": "Time Limit Exceeded", "msg": "", "time": 1104164966, "memory": 9355264}, {"testpoint": 2, "status": "Time Limit Exceeded", "msg": "", "time": 1103844426, "memory": 9367552}, {"testpoint": 3, "status": "Accepted", "msg": "", "time": 744657863, "memory": 5074944}, {"testpoint": 4, "status": "Time Limit Exceeded", "msg": "", "time": 1103192510, "memory": 9379840}, {"testpoint": 5, "status": "Time Limit Exceeded", "msg": "", "time": 1106909549, "memory": 9416704}, {"testpoint": 6, "status": "Time Limit Exceeded", "msg": "", "time": 1103728977, "memory": 9375744}, {"testpoint": 7, "status": "Time Limit Exceeded", "msg": "", "time": 1104276756, "memory": 9375744}, {"testpoint": 8, "status": "Accepted", "msg": "", "time": 8967210, "memory": 4911104}, {"testpoint": 9, "status": "Accepted", "msg": "", "time": 172897417, "memory": 4911104}, {"testpoint": 10, "status": "Time Limit Exceeded", "msg": "", "time": 1103082056, "memory": 6914048}, {"testpoint": 11, "status": "Time Limit Exceeded", "msg": "", "time": 1104401817, "memory": 9482240}], "score": 30, "scorerate": "27%"}