{"title": "Correct Bracket Sequence Editor", "type": "problem", "description": {"format": "html", "value": "<div class=\"ttypography\"><div class=\"problem-statement\"><div class=\"header\" align=\"center\"><div class=\"title\" style=\"display:none\">E. Correct Bracket Sequence Editor</div><div class=\"time-limit\"><div class=\"property-title\">time limit per test</div>2 seconds</div><div class=\"memory-limit\"><div class=\"property-title\">memory limit per test</div>256 megabytes</div><div class=\"input-file\"><div class=\"property-title\">input</div>standard input</div><div class=\"output-file\"><div class=\"property-title\">output</div>standard output</div></div><div><p>Recently Polycarp started to develop a text editor that works only with correct bracket sequences (abbreviated as CBS). </p><p>Note that a bracket sequence is correct if it is possible to get a correct mathematical expression by adding \"<span class=\"tex-font-style-tt\">+</span>\"-s and \"<span class=\"tex-font-style-tt\">1</span>\"-s to it. For example, sequences \"<span class=\"tex-font-style-tt\">(())()</span>\", \"<span class=\"tex-font-style-tt\">()</span>\" and \"<span class=\"tex-font-style-tt\">(()(()))</span>\" are correct, while \"<span class=\"tex-font-style-tt\">)(</span>\", \"<span class=\"tex-font-style-tt\">(()</span>\" and \"<span class=\"tex-font-style-tt\">(()))(</span>\" are not. Each bracket in CBS has a pair. For example, in \"<span class=\"tex-font-style-tt\">(()(()))</span>\":</p><ul> <li> 1st bracket is paired with 8th, </li><li> 2d bracket is paired with 3d, </li><li> 3d bracket is paired with 2d, </li><li> 4th bracket is paired with 7th, </li><li> 5th bracket is paired with 6th, </li><li> 6th bracket is paired with 5th, </li><li> 7th bracket is paired with 4th, </li><li> 8th bracket is paired with 1st. </li></ul><p>Polycarp's editor currently supports only three operations during the use of CBS. The cursor in the editor takes the whole position of one of the brackets (not the position between the brackets!). There are three operations being supported:</p><ul> <li> &laquo;<span class=\"tex-font-style-tt\">L</span>&raquo;&minus; move the cursor one position to the left, </li><li> &laquo;<span class=\"tex-font-style-tt\">R</span>&raquo;&minus; move the cursor one position to the right, </li><li> &laquo;<span class=\"tex-font-style-tt\">D</span>&raquo;&minus; delete the bracket in which the cursor is located, delete the bracket it's paired to and all brackets between them (that is, delete a substring between the bracket in which the cursor is located and the one it's paired to). </li></ul><p>After the operation \"<span class=\"tex-font-style-tt\">D</span>\" the cursor moves to the nearest bracket to the right (of course, among the non-deleted). If there is no such bracket (that is, the suffix of the CBS was deleted), then the cursor moves to the nearest bracket to the left (of course, among the non-deleted). </p><p>There are pictures illustrated several usages of operation \"<span class=\"tex-font-style-tt\">D</span>\" below.</p><center> <img class=\"tex-graphics\" src=\"http://cf.hustoj.com:80/userfiles/image/e8022a9a89fa3f61621d21e23bdf474bbfdb567f3434.png\" style=\"max-width: 100.0%;max-height: 100.0%;\"/> </center><p>All incorrect operations (shift cursor over the end of CBS, delete the whole CBS, etc.) are not supported by Polycarp's editor.</p><p>Polycarp is very proud of his development, can you implement the functionality of his editor?</p></div><div class=\"input-specification\"><div class=\"section-title\">Input</div><p>The first line contains three positive integers <span class=\"tex-span\"><i>n</i></span>, <span class=\"tex-span\"><i>m</i></span> and <span class=\"tex-span\"><i>p</i></span> (<span class=\"tex-span\">2&le;<i>n</i>&le;500000</span>, <span class=\"tex-span\">1&le;<i>m</i>&le;500000</span>, <span class=\"tex-span\">1&le;<i>p</i>&le;<i>n</i></span>)&minus; the number of brackets in the correct bracket sequence, the number of operations and the initial position of cursor. Positions in the sequence are numbered from left to right, starting from one. It is guaranteed that <span class=\"tex-span\"><i>n</i></span> is even.</p><p>It is followed by the string of <span class=\"tex-span\"><i>n</i></span> characters \"<span class=\"tex-font-style-tt\">(</span>\" and \"<span class=\"tex-font-style-tt\">)</span>\" forming the correct bracket sequence.</p><p>Then follow a string of <span class=\"tex-span\"><i>m</i></span> characters \"<span class=\"tex-font-style-tt\">L</span>\", \"<span class=\"tex-font-style-tt\">R</span>\" and \"<span class=\"tex-font-style-tt\">D</span>\"&minus; a sequence of the operations. Operations are carried out one by one from the first to the last. It is guaranteed that the given operations never move the cursor outside the bracket sequence, as well as the fact that after all operations a bracket sequence will be non-empty.</p></div><div class=\"output-specification\"><div class=\"section-title\">Output</div><p>Print the correct bracket sequence, obtained as a result of applying all operations to the initial sequence.</p></div><div class=\"sample-tests\"><div class=\"section-title\">Examples</div><div class=\"sample-test\"><div class=\"input\"><div class=\"title\">Input</div><pre>8 4 5<br/>(())()()<br/>RDLD<br/></pre></div><div class=\"output\"><div class=\"title\">Output</div><pre>()<br/></pre></div><div class=\"input\"><div class=\"title\">Input</div><pre>12 5 3<br/>((()())(()))<br/>RRDLD<br/></pre></div><div class=\"output\"><div class=\"title\">Output</div><pre>(()(()))<br/></pre></div><div class=\"input\"><div class=\"title\">Input</div><pre>8 8 8<br/>(())()()<br/>LLLLLLDD<br/></pre></div><div class=\"output\"><div class=\"title\">Output</div><pre>()()<br/></pre></div></div></div><div class=\"note\"><div class=\"section-title\">Note</div><p>In the first sample the cursor is initially at position <span class=\"tex-span\">5</span>. Consider actions of the editor:</p><ol> <li> command \"<span class=\"tex-font-style-tt\">R</span>\"&minus; the cursor moves to the position <span class=\"tex-span\">6</span> on the right; </li><li> command \"<span class=\"tex-font-style-tt\">D</span>\"&minus; the deletion of brackets from the position <span class=\"tex-span\">5</span> to the position <span class=\"tex-span\">6</span>. After that CBS takes the form <span class=\"tex-font-style-tt\">(())()</span>, the cursor is at the position <span class=\"tex-span\">5</span>; </li><li> command \"<span class=\"tex-font-style-tt\">L</span>\"&minus; the cursor moves to the position <span class=\"tex-span\">4</span> on the left; </li><li> command \"<span class=\"tex-font-style-tt\">D</span>\"&minus; the deletion of brackets from the position <span class=\"tex-span\">1</span> to the position <span class=\"tex-span\">4</span>. After that CBS takes the form <span class=\"tex-font-style-tt\">()</span>, the cursor is at the position <span class=\"tex-span\">1</span>. </li></ol><p>Thus, the answer is equal to <span class=\"tex-font-style-tt\">()</span>.</p></div></div><p> </p></div>\n"}, "tags": ["Codeforces"], "input_description": {"format": "html", "value": ""}, "output_description": {"format": "html", "value": ""}, "test_case_score": [{"score": 10, "input_name": "1.in", "output_name": "1.out"}, {"score": 10, "input_name": "2.in", "output_name": "2.out"}, {"score": 10, "input_name": "3.in", "output_name": "3.out"}, {"score": 10, "input_name": "4.in", "output_name": "4.out"}, {"score": 10, "input_name": "5.in", "output_name": "5.out"}, {"score": 10, "input_name": "6.in", "output_name": "6.out"}, {"score": 10, "input_name": "7.in", "output_name": "7.out"}, {"score": 10, "input_name": "8.in", "output_name": "8.out"}, {"score": 10, "input_name": "9.in", "output_name": "9.out"}], "hint": {"format": "html", "value": ""}, "time_limit": 2000, "memory_limit": 256, "samples": [{"input": "", "output": ""}], "template": {}, "spj": null, "rule_type": "OI", "source": "", "answers": [{"language": "Python3", "code": "print('Hello, world!')"}]}