{"title": "Roads in Yusland", "type": "problem", "description": {"format": "html", "value": "<div class=\"ttypography\"><div class=\"problem-statement\"><div class=\"header\" align=\"center\"><div class=\"title\" style=\"display:none\">D. Roads in Yusland</div><div class=\"time-limit\"><div class=\"property-title\">time limit per test</div>4 seconds</div><div class=\"memory-limit\"><div class=\"property-title\">memory limit per test</div>256 megabytes</div><div class=\"input-file\"><div class=\"property-title\">input</div>standard input</div><div class=\"output-file\"><div class=\"property-title\">output</div>standard output</div></div><div><p>Mayor of Yusland just won the lottery and decided to spent money on something good for town. For example, repair all the roads in the town.</p><p>Yusland consists of <span class=\"tex-span\"><i>n</i></span> intersections connected by <span class=\"tex-span\"><i>n</i>-1</span> bidirectional roads. One can travel from any intersection to any other intersection using only these roads.</p><p>There is only one road repairing company in town, named \"RC company\". Company's center is located at the intersection <span class=\"tex-span\">1</span>. RC company doesn't repair roads you tell them. Instead, they have workers at some intersections, who can repair only some specific paths. The <span class=\"tex-span\"><i>i</i></span>-th worker can be paid <span class=\"tex-span\"><i>c</i><sub class=\"lower-index\"><i>i</i></sub></span> coins and then he repairs <span class=\"tex-font-style-bf\">all roads</span> on a path from <span class=\"tex-span\"><i>u</i><sub class=\"lower-index\"><i>i</i></sub></span> to some <span class=\"tex-span\"><i>v</i><sub class=\"lower-index\"><i>i</i></sub></span> that <span class=\"tex-font-style-bf\">lies on the path</span> from <span class=\"tex-span\"><i>u</i><sub class=\"lower-index\"><i>i</i></sub></span> to intersection <span class=\"tex-span\">1</span>. </p><p>Mayor asks you to choose the cheapest way to hire some subset of workers in order to repair all the roads in Yusland. It's allowed that some roads will be repaired more than once.</p><p>If it's impossible to repair all roads print <span class=\"tex-span\">-1</span>.</p></div><div class=\"input-specification\"><div class=\"section-title\">Input</div><p>The first line of the input contains two integers <span class=\"tex-span\"><i>n</i></span> and <span class=\"tex-span\"><i>m</i></span> (<span class=\"tex-span\">1&le;<i>n</i>,<i>m</i>&le;300000</span>)&minus; the number of cities in Yusland and the number of workers respectively.</p><p>Then follow <span class=\"tex-span\"><i>n</i>&minus;1</span> line, each of them contains two integers <span class=\"tex-span\"><i>x</i><sub class=\"lower-index\"><i>i</i></sub></span> and <span class=\"tex-span\"><i>y</i><sub class=\"lower-index\"><i>i</i></sub></span> (<span class=\"tex-span\">1&le;<i>x</i><sub class=\"lower-index\"><i>i</i></sub>,<i>y</i><sub class=\"lower-index\"><i>i</i></sub>&le;<i>n</i></span>)&minus; indices of intersections connected by the <span class=\"tex-span\"><i>i</i></span>-th road.</p><p>Last <span class=\"tex-span\"><i>m</i></span> lines provide the description of workers, each line containing three integers <span class=\"tex-span\"><i>u</i><sub class=\"lower-index\"><i>i</i></sub></span>, <span class=\"tex-span\"><i>v</i><sub class=\"lower-index\"><i>i</i></sub></span> and <span class=\"tex-span\"><i>c</i><sub class=\"lower-index\"><i>i</i></sub></span> (<span class=\"tex-span\">1&le;<i>u</i><sub class=\"lower-index\"><i>i</i></sub>,<i>v</i><sub class=\"lower-index\"><i>i</i></sub>&le;<i>n</i></span>, <span class=\"tex-span\">1&le;<i>c</i><sub class=\"lower-index\"><i>i</i></sub>&le;10<sup class=\"upper-index\">9</sup></span>). This means that the <span class=\"tex-span\"><i>i</i></span>-th worker can repair all roads on the path from <span class=\"tex-span\"><i>v</i><sub class=\"lower-index\"><i>i</i></sub></span> to <span class=\"tex-span\"><i>u</i><sub class=\"lower-index\"><i>i</i></sub></span> for <span class=\"tex-span\"><i>c</i><sub class=\"lower-index\"><i>i</i></sub></span> coins. It's guaranteed that <span class=\"tex-span\"><i>v</i><sub class=\"lower-index\"><i>i</i></sub></span> lies on the path from <span class=\"tex-span\"><i>u</i><sub class=\"lower-index\"><i>i</i></sub></span> to <span class=\"tex-span\">1</span>. Note that <span class=\"tex-span\"><i>v</i><sub class=\"lower-index\"><i>i</i></sub></span> and <span class=\"tex-span\"><i>u</i><sub class=\"lower-index\"><i>i</i></sub></span> may coincide.</p></div><div class=\"output-specification\"><div class=\"section-title\">Output</div><p>If it's impossible to repair all roads then print <span class=\"tex-span\">-1</span>. Otherwise print a single integer&minus; minimum cost required to repair all roads using \"RC company\" workers.</p></div><div class=\"sample-tests\"><div class=\"section-title\">Example</div><div class=\"sample-test\"><div class=\"input\"><div class=\"title\">Input</div><pre>6 5<br/>1 2<br/>1 3<br/>3 4<br/>4 5<br/>4 6<br/>2 1 2<br/>3 1 4<br/>4 1 3<br/>5 3 1<br/>6 3 2<br/></pre></div><div class=\"output\"><div class=\"title\">Output</div><pre>8<br/></pre></div></div></div><div class=\"note\"><div class=\"section-title\">Note</div><p>In the first sample, we should choose workers with indices <span class=\"tex-span\">1</span>, <span class=\"tex-span\">3</span>, <span class=\"tex-span\">4</span> and <span class=\"tex-span\">5</span>, some roads will be repaired more than once but it is OK. The cost will be equal to <span class=\"tex-span\">2+3+1+2=8</span> coins.</p></div></div><p> </p></div>\n"}, "tags": ["Codeforces"], "input_description": {"format": "html", "value": ""}, "output_description": {"format": "html", "value": ""}, "test_case_score": [{"score": 10, "input_name": "1.in", "output_name": "1.out"}, {"score": 10, "input_name": "2.in", "output_name": "2.out"}, {"score": 10, "input_name": "3.in", "output_name": "3.out"}, {"score": 10, "input_name": "4.in", "output_name": "4.out"}, {"score": 10, "input_name": "5.in", "output_name": "5.out"}, {"score": 10, "input_name": "6.in", "output_name": "6.out"}, {"score": 10, "input_name": "7.in", "output_name": "7.out"}, {"score": 10, "input_name": "8.in", "output_name": "8.out"}, {"score": 10, "input_name": "9.in", "output_name": "9.out"}], "hint": {"format": "html", "value": ""}, "time_limit": 4000, "memory_limit": 256, "samples": [{"input": "", "output": ""}], "template": {}, "spj": null, "rule_type": "OI", "source": "", "answers": [{"language": "Python3", "code": "print('Hello, world!')"}]}