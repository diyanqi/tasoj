{"title": "Garlands", "type": "problem", "description": {"format": "html", "value": "<div class=\"ttypography\"><div class=\"problem-statement\"><div class=\"header\" align=\"center\"><div class=\"title\" style=\"display:none\">E. Garlands</div><div class=\"time-limit\"><div class=\"property-title\">time limit per test</div>3 seconds</div><div class=\"memory-limit\"><div class=\"property-title\">memory limit per test</div>256 megabytes</div><div class=\"input-file\"><div class=\"property-title\">input</div>standard input</div><div class=\"output-file\"><div class=\"property-title\">output</div>standard output</div></div><div><p>Like all children, Alesha loves New Year celebration. During the celebration he and his whole family dress up the fir-tree. Like all children, Alesha likes to play with garlands&minus; chains consisting of a lightbulbs.</p><p>Alesha uses a grid field sized <span class=\"tex-span\"><i>n</i>&times;<i>m</i></span> for playing. The rows of the field are numbered from <span class=\"tex-span\">1</span> to <span class=\"tex-span\"><i>n</i></span> from the top to the bottom and columns are numbered from <span class=\"tex-span\">1</span> to <span class=\"tex-span\"><i>m</i></span> from the left to the right.</p><p>Alesha has <span class=\"tex-span\"><i>k</i></span> garlands which he places at the field. He does so in the way such that each lightbulb of each garland lies in the center of some cell in the field, and each cell contains <span class=\"tex-font-style-bf\">at most one lightbulb</span>. Of course lightbulbs, which are neighbours in some garland, appears in cells neighbouring by a side.</p><center><p><img class=\"tex-graphics\" src=\"http://cf.hustoj.com:80/userfiles/image/de2fd9b59bb13b20ce0055face271236f21b843b39.png\" style=\"max-width: 100.0%;max-height: 100.0%;\"/></p><p>The example of garland placing.</p></center><p>Each garland is turned off or turned on at any moment. If some garland is turned on then each of its lightbulbs is turned on, the same applies for garland turned off. Each lightbulb in the whole garland set is unique, and thus, being turned on, brings Alesha some pleasure, described by an integer value. Turned off lightbulbs don't bring Alesha any pleasure.</p><p>Alesha can turn garlands on and off and wants to know the sum of pleasure value which the lightbulbs, placed in the centers of the cells in some rectangular part of the field, bring him. Initially <span class=\"tex-font-style-bf\">all the garlands are turned on</span>.</p><p>Alesha is still very little and can't add big numbers. He extremely asks you to help him.</p></div><div class=\"input-specification\"><div class=\"section-title\">Input</div><p>The first line of the input contains three integers <span class=\"tex-span\"><i>n</i></span>, <span class=\"tex-span\"><i>m</i></span> and <span class=\"tex-span\"><i>k</i></span> (<span class=\"tex-span\">1&le;<i>n</i>,<i>m</i>,<i>k</i>&le;2000</span>)&minus; the number of field rows, the number of field columns and the number of garlands placed at the field respectively.</p><p>Next lines contains garlands set description in the following format:</p><p>The first line of a single garland description contains a single integer <span class=\"tex-span\"><i>len</i></span> (<span class=\"tex-span\">1&le;<i>len</i>&le;2000</span>)&minus; the number of lightbulbs in the garland.</p><p>Each of the next <span class=\"tex-span\"><i>len</i></span> lines contains three integers <span class=\"tex-span\"><i>i</i></span>, <span class=\"tex-span\"><i>j</i></span> and <span class=\"tex-span\"><i>w</i></span> (<span class=\"tex-span\">1&le;<i>i</i>&le;<i>n</i></span>, <span class=\"tex-span\">1&le;<i>j</i>&le;<i>m</i></span>, <span class=\"tex-span\">1&le;<i>w</i>&le;10<sup class=\"upper-index\">9</sup></span>)&minus; the coordinates of the cell containing a lightbullb and pleasure value Alesha gets from it if it is turned on. The lightbulbs are given in the order they are forming a chain in the garland. It is guaranteed that neighbouring lightbulbs are placed in the cells neighbouring by a side.</p><p>The next line contains single integer <span class=\"tex-span\"><i>q</i></span> (<span class=\"tex-span\">1&le;<i>q</i>&le;10<sup class=\"upper-index\">6</sup></span>)&minus; the number of events in Alesha's game. The next <span class=\"tex-span\"><i>q</i></span> lines describes events in chronological order. The <span class=\"tex-span\"><i>i</i></span>-th of them describes the <span class=\"tex-span\"><i>i</i></span>-th event in the one of the following formats:</p><ul> <li> <span class=\"tex-font-style-tt\">SWITCH</span> <span class=\"tex-span\"><i>i</i></span>&minus; Alesha turns off <span class=\"tex-span\"><i>i</i></span>-th garland if it is turned on, or turns it on if it is turned off. It is guaranteed that <span class=\"tex-span\">1&le;<i>i</i>&le;<i>k</i></span>. </li><li> <span class=\"tex-font-style-tt\">ASK</span> <span class=\"tex-span\"><i>x</i><sub class=\"lower-index\">1</sub></span> <span class=\"tex-span\"><i>y</i><sub class=\"lower-index\">1</sub></span> <span class=\"tex-span\"><i>x</i><sub class=\"lower-index\">2</sub></span> <span class=\"tex-span\"><i>y</i><sub class=\"lower-index\">2</sub></span>&minus; Alesha wants to know the sum of pleasure values the lightbulbs, placed in a rectangular part of the field. Top-left cell of a part has coordinates <span class=\"tex-span\">(<i>x</i><sub class=\"lower-index\">1</sub>,<i>y</i><sub class=\"lower-index\">1</sub>)</span> and right-bottom cell has coordinates <span class=\"tex-span\">(<i>x</i><sub class=\"lower-index\">2</sub>,<i>y</i><sub class=\"lower-index\">2</sub>)</span>. It is guaranteed that <span class=\"tex-span\">1&le;<i>x</i><sub class=\"lower-index\">1</sub>&le;<i>x</i><sub class=\"lower-index\">2</sub>&le;<i>n</i></span> and <span class=\"tex-span\">1&le;<i>y</i><sub class=\"lower-index\">1</sub>&le;<i>y</i><sub class=\"lower-index\">2</sub>&le;<i>m</i></span>. There is <span class=\"tex-font-style-bf\">no more than <span class=\"tex-span\">2000</span></span> events of this type in the input. </li></ul><p>All the numbers in the input are integers.</p><p>Please note that the input is quite large, so be careful while using some input ways. In particular, it's not recommended to use <span class=\"tex-font-style-tt\">cin</span> in codes on <span class=\"tex-font-style-tt\">C++</span> and class <span class=\"tex-font-style-tt\">Scanner</span> in codes on <span class=\"tex-font-style-tt\">Java</span>.</p></div><div class=\"output-specification\"><div class=\"section-title\">Output</div><p>For each <span class=\"tex-font-style-tt\">ASK</span> operation print the sum Alesha wants to know in a separate line. Print the answers in chronological order.</p></div><div class=\"sample-tests\"><div class=\"section-title\">Examples</div><div class=\"sample-test\"><div class=\"input\"><div class=\"title\">Input</div><pre>4 4 3<br/>5<br/>1 1 2<br/>1 2 3<br/>2 2 1<br/>2 1 4<br/>3 1 7<br/>4<br/>1 3 1<br/>2 3 3<br/>2 4 3<br/>1 4 1<br/>7<br/>4 1 1<br/>4 2 9<br/>3 2 8<br/>3 3 3<br/>4 3 4<br/>4 4 1<br/>3 4 1<br/>2<br/>ASK 2 2 3 3<br/>ASK 1 1 4 4<br/></pre></div><div class=\"output\"><div class=\"title\">Output</div><pre>15<br/>52<br/></pre></div><div class=\"input\"><div class=\"title\">Input</div><pre>4 4 1<br/>8<br/>4 1 1<br/>3 1 2<br/>2 1 1<br/>1 1 7<br/>1 2 5<br/>2 2 4<br/>2 3 1<br/>1 3 1<br/>3<br/>ASK 1 1 3 2<br/>SWITCH 1<br/>ASK 1 1 3 2<br/></pre></div><div class=\"output\"><div class=\"title\">Output</div><pre>19<br/>0<br/></pre></div></div></div><div class=\"note\"><div class=\"section-title\">Note</div><center><p><img class=\"tex-graphics\" src=\"http://cf.hustoj.com:80/userfiles/image/8f29519956225751270c7f494b172929251a1a2439.png\" style=\"max-width: 100.0%;max-height: 100.0%;\"/></p><p>This image illustrates the first sample case.</p></center></div></div><p> </p></div>\n"}, "tags": ["Codeforces"], "input_description": {"format": "html", "value": ""}, "output_description": {"format": "html", "value": ""}, "test_case_score": [{"score": 10, "input_name": "1.in", "output_name": "1.out"}, {"score": 10, "input_name": "2.in", "output_name": "2.out"}, {"score": 10, "input_name": "3.in", "output_name": "3.out"}, {"score": 10, "input_name": "4.in", "output_name": "4.out"}, {"score": 10, "input_name": "5.in", "output_name": "5.out"}, {"score": 10, "input_name": "6.in", "output_name": "6.out"}, {"score": 10, "input_name": "7.in", "output_name": "7.out"}, {"score": 10, "input_name": "8.in", "output_name": "8.out"}, {"score": 10, "input_name": "9.in", "output_name": "9.out"}], "hint": {"format": "html", "value": ""}, "time_limit": 3000, "memory_limit": 256, "samples": [{"input": "", "output": ""}], "template": {}, "spj": null, "rule_type": "OI", "source": "", "answers": [{"language": "Python3", "code": "print('Hello, world!')"}]}