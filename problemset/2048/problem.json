{"title": "Coprime Permutation", "type": "problem", "description": {"format": "html", "value": "<div class=\"ttypography\"><div class=\"problem-statement\"><div class=\"header\" align=\"center\"><div class=\"title\" style=\"display:none\">F. Coprime Permutation</div><div class=\"time-limit\"><div class=\"property-title\">time limit per test</div>2 seconds</div><div class=\"memory-limit\"><div class=\"property-title\">memory limit per test</div>256 megabytes</div><div class=\"input-file\"><div class=\"property-title\">input</div>standard input</div><div class=\"output-file\"><div class=\"property-title\">output</div>standard output</div></div><div><p>Two positive integers are coprime if and only if they don't have a common divisor greater than <span class=\"tex-span\">1</span>.</p><p>Some bear doesn't want to tell Radewoosh how to solve some algorithmic problem. So, Radewoosh is going to break into that bear's safe with solutions. To pass through the door, he must enter a permutation of numbers <span class=\"tex-span\">1</span> through <span class=\"tex-span\"><i>n</i></span>. The door opens if and only if an entered permutation <span class=\"tex-span\"><i>p</i><sub class=\"lower-index\">1</sub>,<i>p</i><sub class=\"lower-index\">2</sub>,...,<i>p</i><sub class=\"lower-index\"><i>n</i></sub></span> satisfies:</p><center class=\"tex-equation\"><img align=\"middle\" class=\"tex-formula\" src=\"http://cf.hustoj.com:80/userfiles/image/3fa3b1e3cc0f89d2971027ca4c80f3570a4e983538.png\" style=\"max-width: 100.0%;max-height: 100.0%;\"/></center><p>In other words, two different elements are coprime if and only if their indices are coprime. </p><p>Some elements of a permutation may be already fixed. In how many ways can Radewoosh fill the remaining gaps so that the door will open? Print the answer modulo <span class=\"tex-span\">10<sup class=\"upper-index\">9</sup>+7</span>.</p></div><div class=\"input-specification\"><div class=\"section-title\">Input</div><p>The first line of the input contains one integer <span class=\"tex-span\"><i>n</i></span> (<span class=\"tex-span\">2&le;<i>n</i>&le;1000000</span>).</p><p>The second line contains <span class=\"tex-span\"><i>n</i></span> integers <span class=\"tex-span\"><i>p</i><sub class=\"lower-index\">1</sub>,<i>p</i><sub class=\"lower-index\">2</sub>,...,<i>p</i><sub class=\"lower-index\"><i>n</i></sub></span> (<span class=\"tex-span\">0&le;<i>p</i><sub class=\"lower-index\"><i>i</i></sub>&le;<i>n</i></span>) where <span class=\"tex-span\"><i>p</i><sub class=\"lower-index\"><i>i</i></sub>=0</span> means a gap to fill, and <span class=\"tex-span\"><i>p</i><sub class=\"lower-index\"><i>i</i></sub>&ge;1</span> means a fixed number.</p><p>It's guaranteed that if <span class=\"tex-span\"><i>i</i>&ne;<i>j</i></span> and <span class=\"tex-span\"><i>p</i><sub class=\"lower-index\"><i>i</i></sub>,<i>p</i><sub class=\"lower-index\"><i>j</i></sub>&ge;1</span> then <span class=\"tex-span\"><i>p</i><sub class=\"lower-index\"><i>i</i></sub>&ne;<i>p</i><sub class=\"lower-index\"><i>j</i></sub></span>.</p></div><div class=\"output-specification\"><div class=\"section-title\">Output</div><p>Print the number of ways to fill the gaps modulo <span class=\"tex-span\">10<sup class=\"upper-index\">9</sup>+7</span> (i.e. modulo <span class=\"tex-span\">1000000007</span>).</p></div><div class=\"sample-tests\"><div class=\"section-title\">Examples</div><div class=\"sample-test\"><div class=\"input\"><div class=\"title\">Input</div><pre>4<br/>0 0 0 0<br/></pre></div><div class=\"output\"><div class=\"title\">Output</div><pre>4<br/></pre></div><div class=\"input\"><div class=\"title\">Input</div><pre>5<br/>0 0 1 2 0<br/></pre></div><div class=\"output\"><div class=\"title\">Output</div><pre>2<br/></pre></div><div class=\"input\"><div class=\"title\">Input</div><pre>6<br/>0 0 1 2 0 0<br/></pre></div><div class=\"output\"><div class=\"title\">Output</div><pre>0<br/></pre></div><div class=\"input\"><div class=\"title\">Input</div><pre>5<br/>5 3 4 2 1<br/></pre></div><div class=\"output\"><div class=\"title\">Output</div><pre>0<br/></pre></div></div></div><div class=\"note\"><div class=\"section-title\">Note</div><p>In the first sample test, none of four element is fixed. There are four permutations satisfying the given conditions: (1,2,3,4), (1,4,3,2), (3,2,1,4), (3,4,1,2).</p><p>In the second sample test, there must be <span class=\"tex-span\"><i>p</i><sub class=\"lower-index\">3</sub>=1</span> and <span class=\"tex-span\"><i>p</i><sub class=\"lower-index\">4</sub>=2</span>. The two permutations satisfying the conditions are: (3,4,1,2,5), (5,4,1,2,3).</p></div></div><p> </p></div>\n"}, "tags": ["Codeforces"], "input_description": {"format": "html", "value": ""}, "output_description": {"format": "html", "value": ""}, "test_case_score": [{"score": 10, "input_name": "1.in", "output_name": "1.out"}, {"score": 10, "input_name": "2.in", "output_name": "2.out"}, {"score": 10, "input_name": "3.in", "output_name": "3.out"}, {"score": 10, "input_name": "4.in", "output_name": "4.out"}, {"score": 10, "input_name": "5.in", "output_name": "5.out"}, {"score": 10, "input_name": "6.in", "output_name": "6.out"}, {"score": 10, "input_name": "7.in", "output_name": "7.out"}, {"score": 10, "input_name": "8.in", "output_name": "8.out"}, {"score": 10, "input_name": "9.in", "output_name": "9.out"}], "hint": {"format": "html", "value": ""}, "time_limit": 2000, "memory_limit": 256, "samples": [{"input": "", "output": ""}], "template": {}, "spj": null, "rule_type": "OI", "source": "", "answers": [{"language": "Python3", "code": "print('Hello, world!')"}]}